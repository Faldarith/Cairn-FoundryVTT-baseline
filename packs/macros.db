{"_id":"KqJ2JhHl2tzKHcio","name":"Generate character","permission":{"default":0,"a9Mphu6C9SuGXue4":3},"type":"script","flags":{"core":{"sourceId":"Macro.3zRg0cgONbT8eqmY"}},"scope":"global","command":"async function Create() {\nlet strength = new Roll(\"3d6\").roll().total;\nlet dexterity = new Roll(\"3d6\").roll().total;\nlet will = new Roll(\"3d6\").roll().total;\nlet hp = new Roll(\"1d6\").roll().total;\nlet gold = new Roll(\"3d6\").roll().total;\n// name\nlet maleNamesTable = game.tables.entities.find(t => t.name === \"Male Names\");\nlet femaleNamesTable = game.tables.entities.find(t => t.name === \"Female Names\");\nlet genderRoll = new Roll(\"1d6\").roll().total % 2;\nlet firstName = \"\";\nif (genderRoll == 1) {\n  firstName += maleNamesTable.roll().results[0].text;\n} else {\n  firstName += femaleNamesTable.roll().results[0].text;\n}\nconst surname = game.tables.entities.find(t => t.name === \"Surnames\").roll().results[0].text;\nconst characterName = firstName + \" \" + surname;\n// biography\nconst face = game.tables.entities.find(t => t.name === \"Face\").roll().results[0].text.toLowerCase();\nconst hair = game.tables.entities.find(t => t.name === \"Hair\").roll().results[0].text.toLowerCase();\nconst skin = game.tables.entities.find(t => t.name === \"Skin\").roll().results[0].text.toLowerCase();\nconst physique = game.tables.entities.find(t => t.name === \"Physique\").roll().results[0].text.toLowerCase();\nconst misfortune = game.tables.entities.find(t => t.name === \"Misfortunes\").roll().results[0].text.toLowerCase();\nconst reputation = game.tables.entities.find(t => t.name === \"Reputation\").roll().results[0].text.toLowerCase();\nconst speech = game.tables.entities.find(t => t.name === \"Speech\").roll().results[0].text.toLowerCase();\nconst vice = game.tables.entities.find(t => t.name === \"Vice\").roll().results[0].text.toLowerCase();\nconst virtue = game.tables.entities.find(t => t.name === \"Virtue\").roll().results[0].text.toLowerCase();\nconst clothing = game.tables.entities.find(t => t.name === \"Clothing\").roll().results[0].text.toLowerCase();\nconst characterBackground = game.tables.entities.find(t => t.name === \"Background\").roll().results[0].text;\nlet biography = `I have a <strong>${physique}</strong> physique, <strong>${skin}</strong> skin, <strong>${hair}</strong> hair, and a <strong>${face}</strong> face. I speak in a <strong>${speech}</strong> manner and wear <strong>${clothing}</strong> clothing. I am <strong>${vice}</strong> yet <strong>${virtue}</strong>, and I am generally regarded as <strong>${reputation}</strong>. I have had the misfortune of being <strong>${misfortune}</strong>. I am <strong>36</strong> years old.`;\nlet actorData = {\n  name: characterName,\n  background: characterBackground,\n  biography: biography,\n  hp: { value: hp, max: hp },\n  gold: gold,\n  \"abilities\": {\n    \"STR\": {\n      \"value\": strength,\n      \"max\": strength\n    },\n    \"DEX\": {\n      \"value\": dexterity,\n      \"max\": dexterity\n    },\n    \"WIL\": {\n      \"value\": will,\n      \"max\": will\n    }\n  },\n};\nlet actor = await Actor.create({\n  name: characterName,\n  type: \"character\",\n  img: \"icons/svg/mystery-man.svg\",\n  sort: 12000,\n  data: actorData,\n  token: {},\n  items: [],\n  flags: {}\n});\n\nif(actor){\n  const data = duplicate(game.items.getName(\"Rations\"));\n  data.data.quantity = 3;\n  actor.createOwnedItem(data);\n}\n\n\nconst torch = game.items.find(i => i.name === \"Torch\");\nactor.createOwnedItem(torch.data);\n\nconst TABLE_NAMES = [\"Trinkets\", \"Weapons\", \"Helmets and Shields\", \"Armor\", \"Expeditionary Gear\", \"Spellbooks\", \"Bonus Item\"];\nlet itemData = TABLE_NAMES.flatMap(n => game.tables.getName(n).roll().results).map(r => game.items.get(r.resultId)?.data).filter(d => d);\nactor.createOwnedItem(itemData);\n};\n\nCreate();","author":"a9Mphu6C9SuGXue4","img":"systems/cairn/tokens/png/gear/person.png","actorIds":[]}
{"_id":"KqJ2JhHl2tzKHcio","name":"Generate character","permission":{"default":0,"a9Mphu6C9SuGXue4":3},"type":"script","flags":{"core":{"sourceId":"Macro.3zRg0cgONbT8eqmY"}},"scope":"global","command":"async function Create() {\nlet strength = new Roll(\"3d6\").roll().total;\nlet dexterity = new Roll(\"3d6\").roll().total;\nlet will = new Roll(\"3d6\").roll().total;\nlet hp = new Roll(\"1d6\").roll().total;\nlet gold = new Roll(\"3d6\").roll().total;\n// name\nlet maleNamesTable = game.tables.entities.find(t => t.name === \"Male Names\");\nlet femaleNamesTable = game.tables.entities.find(t => t.name === \"Female Names\");\nlet genderRoll = new Roll(\"1d6\").roll().total % 2;\nlet firstName = \"\";\nif (genderRoll == 1) {\n  firstName += maleNamesTable.roll().results[0].text;\n} else {\n  firstName += femaleNamesTable.roll().results[0].text;\n}\nconst surname = game.tables.entities.find(t => t.name === \"Surnames\").roll().results[0].text;\nconst characterName = firstName + \" \" + surname;\n// biography\nconst face = game.tables.entities.find(t => t.name === \"Face\").roll().results[0].text.toLowerCase();\nconst hair = game.tables.entities.find(t => t.name === \"Hair\").roll().results[0].text.toLowerCase();\nconst skin = game.tables.entities.find(t => t.name === \"Skin\").roll().results[0].text.toLowerCase();\nconst physique = game.tables.entities.find(t => t.name === \"Physique\").roll().results[0].text.toLowerCase();\nconst misfortune = game.tables.entities.find(t => t.name === \"Misfortunes\").roll().results[0].text.toLowerCase();\nconst reputation = game.tables.entities.find(t => t.name === \"Reputation\").roll().results[0].text.toLowerCase();\nconst speech = game.tables.entities.find(t => t.name === \"Speech\").roll().results[0].text.toLowerCase();\nconst vice = game.tables.entities.find(t => t.name === \"Vice\").roll().results[0].text.toLowerCase();\nconst virtue = game.tables.entities.find(t => t.name === \"Virtue\").roll().results[0].text.toLowerCase();\nconst clothing = game.tables.entities.find(t => t.name === \"Clothing\").roll().results[0].text.toLowerCase();\nconst characterBackground = game.tables.entities.find(t => t.name === \"Background\").roll().results[0].text;\nlet biography = `I have a <strong>${physique}</strong> physique, <strong>${skin}</strong> skin, <strong>${hair}</strong> hair, and a <strong>${face}</strong> face. I speak in a <strong>${speech}</strong> manner and wear <strong>${clothing}</strong> clothing. I am <strong>${vice}</strong> yet <strong>${virtue}</strong>, and I am generally regarded as <strong>${reputation}</strong>. I have had the misfortune of being <strong>${misfortune}</strong>. I am <strong>36</strong> years old.`;\nlet actorData = {\n  name: characterName,\n  background: characterBackground,\n  biography: biography,\n  hp: { value: hp, max: hp },\n  gold: gold,\n  \"abilities\": {\n    \"STR\": {\n      \"value\": strength,\n      \"max\": strength\n    },\n    \"DEX\": {\n      \"value\": dexterity,\n      \"max\": dexterity\n    },\n    \"WIL\": {\n      \"value\": will,\n      \"max\": will\n    }\n  },\n};\nlet actor = await Actor.create({\n  name: characterName,\n  type: \"character\",\n  img: \"icons/svg/mystery-man.svg\",\n  sort: 12000,\n  data: actorData,\n  token: {},\n  items: [],\n  flags: {}\n});\n\nif(actor){\n  const data = duplicate(game.items.getName(\"Rations\"));\n  data.data.quantity = 3;\n  actor.createOwnedItem(data);\n}\n\nconst torch = game.items.find(i => i.name === \"Torch\");\nactor.createOwnedItem(torch.data);\n\nconst TABLE_NAMES = [\"Armor\", \"Helmets and Shields\", \"Weapons\", \"Expeditionary Gear\", \"Tools\", \"Trinkets\", \"Bonus Item\"];\nlet itemData = TABLE_NAMES.flatMap(n => game.tables.getName(n).roll().results).map(r => game.items.get(r.resultId)?.data).filter(d => d);\nactor.createOwnedItem(itemData);\n};\n\nCreate();","author":"a9Mphu6C9SuGXue4","img":"systems/cairn/tokens/png/gear/person.png","actorIds":[]}
